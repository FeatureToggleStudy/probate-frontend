<script src="/public/javascripts/jquery-1.11.3.js"></script>

<script src="/public/javascripts/govuk-frontend/components/button/button.js"></script>
<script src="/public/javascripts/govuk-frontend/components/checkboxes/checkboxes.js"></script>
<script src="/public/javascripts/govuk-frontend/components/details/details.js"></script>
<script src="/public/javascripts/govuk-frontend/components/error-summary/error-summary.js"></script>
<script src="/public/javascripts/govuk-frontend/components/header/header.js"></script>
<script src="/public/javascripts/govuk-frontend/components/radios/radios.js"></script>
<script nonce="{{ globals.nonce }}">
    // Set the options to an empty object by default if no options are passed.
    options = typeof options !== 'undefined' ? options : {};

    // Allow the user to initialise GOV.UK Frontend in only certain sections of the page
    // Defaults to the entire document if nothing is set.
    var scope = typeof options.scope !== 'undefined' ? options.scope : document;

    // Find all buttons with [role=button] on the scope to enhance.
    new Button(scope).init();

    // Find all global details elements to enhance.
    var $details = scope.querySelectorAll('details');
    nodeListForEach($details, function ($detail) {
        new Details($detail).init();
    });

    var $checkboxes = scope.querySelectorAll('[data-module="checkboxes"]');
    nodeListForEach($checkboxes, function ($checkbox) {
        new Checkboxes($checkbox).init();
    });

    // Find first error summary module to enhance.
    var $errorSummary = scope.querySelector('[data-module="error-summary"]');
    new ErrorSummary($errorSummary).init();

    // Find first header module to enhance.
    var $toggleButton = scope.querySelector('[data-module="header"]');
    new Header($toggleButton).init();

    var $radios = scope.querySelectorAll('[data-module="radios"]');
    nodeListForEach($radios, function ($radio) {
        new Radios($radio).init();
    });
</script>

{% if globals.enableTracking == "true" %}
    <script nonce="{{ globals.nonce }}">
        const gatrackingid = "{{ globals.gaTrackingId }}";
    </script>
    <script src="/public/javascripts/ga-tracking.js"></script>
    <noscript>
        <img src="/public/images/noJS.png" width="1" height="1" alt="No JS">
    </noscript>
{% endif %}

<script src="/public/javascripts/dropzone.js"></script>
<script nonce="{{ globals.nonce }}">
    const documentUploadConfig = {
        csrfToken: '{{ csrfToken }}',
        validMimeTypes: '{{ globals.documentUpload.validMimeTypes }}',
        maxFiles: '{{ globals.documentUpload.maxFiles }}',
        maxSizeBytes: '{{ globals.documentUpload.maxSizeBytes }}',
        timeout: '{{ globals.documentUpload.timeout }}',
        content: {
            removeFileText: '{{ common.documentUploadRemoveFile }}',
            errorSummaryHeading: '{{ common.errorSummaryHeading }}',
            invalidFileType: '{{ common["documentUpload-invalidFileType"] }}',
            invalidFileTypeSummary: '{{ common["documentUpload-invalidFileTypeSummary"] }}',
            maxFiles: '{{ common["documentUpload-maxFiles"] }}',
            maxFilesSummary: '{{ common["documentUpload-maxFilesSummary"] }}',
            maxSize: '{{ common["documentUpload-maxSize"] }}',
            maxSizeSummary: '{{ common["documentUpload-maxSizeSummary"] }}',
            uploadFailed: '{{ common["documentUpload-uploadFailed"] }}',
            uploadFailedSummary: '{{ common["documentUpload-uploadFailedSummary"] }}',
            uploadTimeout: '{{ common["documentUpload-uploadTimeout"] }}',
            uploadTimeoutSummary: '{{ common["documentUpload-uploadTimeoutSummary"] }}'
        }
    };
</script>
<script src="/public/javascripts/document-upload.js"></script>

<!--[if lte IE 9]>
<script src="/public/javascripts/form-polyfill.js"></script>
<![endif]-->

{% if fields.featureToggles.value.webchat == "true" %}
    <script src="/webchat/javascript/hmcts-webchat.js"></script>
    <script nonce="{{ globals.nonce }}">
        webchat_init({
            uuid: 'script_{{ globals.webChat.chatId }}',
            tenant: '{{ globals.webChat.tenant }}',
            channel: 'Probate',
            stylesheetURL: 'https://' + window.location.hostname + '/public/stylesheets/hmcts-webchat.css',
            busHandlerURL: 'https://' + window.location.hostname + '/webchat/javascript/hmcts-webchat-busHandler.js',
            btnNoAgents: '/{{ globals.webChat.tenant }}/button_{{ globals.webChat.buttonNoAgents }}/img/logo',
            btnAgentsBusy: '/{{ globals.webChat.tenant }}/button_{{ globals.webChat.buttonAgentsBusy }}/img/logo',
            btnServiceClosed: '/{{ globals.webChat.tenant }}/button_{{ globals.webChat.buttonServiceClosed }}/img/logo',
            chatDownAction: 'showMessage',
            chatLinkFocusable: false,
            textChatDown: '{{ common.chatDown | replace("\n", "\\n") }}',
            textChatClosed: '{{ common.chatClosed | replace("\n", "\\n") }}',
            textChatWithAnAgent: '{{ common.chatWithAnAgent | replace("\n", "\\n") }}',
            textNoAgentsAvailable: '{{ common.noAgentsAvailable | replace("\n", "\\n") }}',
            textAllAgentsBusy: '{{ common.allAgentsBusy | replace("\n", "\\n") }}',
            textChatAlreadyOpen: '{{ common.chatAlreadyOpen | replace("\\n", "\\\\n") }}',
            textAdditional: '{{ common.chatOpeningHours | replace("\n", "\\n") }}',
        });
    </script>
{% endif %}
